!function(t){var e;window.UIkit&&(e=t(UIkit)),"function"==typeof define&&define.amd&&define("uikit-sortable",["uikit"],function(){return e||t(UIkit)})}(function(t){"use strict";var e,o,s,a,n,r,i,l,h=["touchmove","mousemove","mouseout"],d=["touchmove","mousemove"],u=["touchstart","mousedown"];return t.component("sortable",{defaults:{animation:150,threshold:10,childClass:"uk-sortable-item",placeholderClass:"uk-sortable-placeholder",overClass:"uk-sortable-over",draggingClass:"uk-sortable-dragged",dragMovingClass:"uk-sortable-moving",baseClass:"uk-sortable",noDragClass:"uk-sortable-nodrag",emptyClass:"uk-sortable-empty",dragCustomClass:"",handleClass:!1,group:!1,stop:function(){},start:function(){},change:function(){}},boot:function(){t.ready(function(e){t.$("[data-uk-sortable]",e).each(function(){var e=t.$(this);e.data("sortable")||t.sortable(e,t.Utils.options(e.attr("data-uk-sortable")))})}),t.$html.on("mousemove touchmove",function(o){if(n){var s=o.originalEvent.targetTouches?o.originalEvent.targetTouches[0]:o;(Math.abs(s.pageX-n.pos.x)>n.threshold||Math.abs(s.pageY-n.pos.y)>n.threshold)&&n.apply(s)}if(e){a||(a=!0,e.show(),e.$current.addClass(e.$sortable.options.placeholderClass),e.$sortable.element.children().addClass(e.$sortable.options.childClass),t.$html.addClass(e.$sortable.options.dragMovingClass));var r=e.data("mouse-offset"),i=parseInt(o.originalEvent.touches&&o.originalEvent.touches[0]?o.originalEvent.touches[0].pageX:o.originalEvent.pageX,10)+r.left,l=parseInt(o.originalEvent.touches&&o.originalEvent.touches[0]?o.originalEvent.touches[0].pageY:o.originalEvent.pageY,10)+r.top;if(e.css({left:i,top:l}),l+e.height()/3>document.body.offsetHeight)return;l<t.$win.scrollTop()?t.$win.scrollTop(t.$win.scrollTop()-Math.ceil(e.height()/3)):l+e.height()/3>window.innerHeight+t.$win.scrollTop()&&t.$win.scrollTop(t.$win.scrollTop()+Math.ceil(e.height()/3))}}),t.$html.on("mouseup touchend",function(s){if(n=!1,o&&e){var a=function(e){e=t.$(e);do{if(e.data("sortable"))return e;e=t.$(e).parent()}while(e.length);return e}(o),r=e.$sortable,i={type:s.type};a[0]&&r.dragDrop(i,r.element),r.dragEnd(i,r.element)}else o=e=null})},init:function(){var e=this,a=this.element[0];r=[],this.checkEmptyList(),this.element.data("sortable-group",this.options.group?this.options.group:t.Utils.uid("sortable-group"));var n=g(function(o){if(!o.data||!o.data.sortable){var s=t.$(o.target),n=s.is("a[href]")?s:s.parents("a[href]");if(!s.is(":input"))return o.preventDefault(),!o.touches&&n.length&&n.one("click",function(t){t.preventDefault()}).one("mouseup",function(){i||n.trigger("click")}),o.data=o.data||{},o.data.sortable=a,e.dragStart(o,this)}}),c=(g(t.Utils.debounce(function(t){return e.dragEnter(t,this)})),g(function(o){var s=e.dragenterData(this);e.dragenterData(this,s-1),e.dragenterData(this)||(t.$(this).removeClass(e.options.overClass),e.dragenterData(this,!1))}),g(function(t){return!o||o===this||s===this||(e.element.children().removeClass(e.options.overClass),s=this,e.moveElementNextTo(o,this),function(t){t.stopPropagation&&t.stopPropagation();t.preventDefault&&t.preventDefault();t.returnValue=!1}(t))}));function p(t){o&&e.dragMove(t,e)}function g(o){return function(s){var n,r,i;s&&(r=(n=s.touches&&s.touches[0]||{}).target||s.target,s.touches&&s.touches[0]&&document.elementFromPoint&&(r=document.elementFromPoint(n.pageX-document.body.scrollLeft,n.pageY-document.body.scrollTop)),l=t.$(r)),t.$(r).hasClass(e.options.childClass)?o.apply(r,[s]):r!==a&&(i=function(t,e){var o=e;if(o==t)return null;for(;o;){if(o.parentNode===t)return o;if(!(o=o.parentNode)||!o.ownerDocument||11===o.nodeType)break}return null}(a,r))&&o.apply(i,[s])}}this.addDragHandlers=function(){h.forEach(function(t){a.addEventListener(t,c,!1)})},this.removeDragHandlers=function(){h.forEach(function(t){a.removeEventListener(t,c,!1)})},d.forEach(function(t){window.addEventListener(t,p,!1)}),u.forEach(function(t){a.addEventListener(t,n,!1)})},dragStart:function(s,r){i=!1,a=!1,!1;var l=this,h=t.$(s.target);if(s.touches||2!=s.button){if(l.options.handleClass)if(!(h.hasClass(l.options.handleClass)?h:h.closest("."+l.options.handleClass,l.element)).length)return;if(!h.is("."+l.options.noDragClass)&&!h.closest("."+l.options.noDragClass).length&&!h.is(":input")){o=r,e&&e.remove();var d=t.$(o),u=d.offset();n={pos:{x:s.touches&&s.touches[0]?s.touches[0].pageX:s.pageX,y:s.touches&&s.touches[0]?s.touches[0].pageY:s.pageY},threshold:l.options.threshold,apply:function(s){(e=t.$('<div class="'+[l.options.draggingClass,l.options.dragCustomClass].join(" ")+'"></div>').css({display:"none",top:u.top,left:u.left,width:d.width(),height:d.height(),padding:d.css("padding")}).data({"mouse-offset":{left:u.left-parseInt(s.pageX,10),top:u.top-parseInt(s.pageY,10)},origin:l.element,index:d.index()}).append(d.html()).appendTo("body")).$current=d,e.$sortable=l,d.data({"start-list":d.parent(),"start-index":d.index(),"sortable-group":l.options.group}),l.addDragHandlers(),l.options.start(this,o),l.trigger("start.uk.sortable",[l,o]),i=!0,n=!1}}}}},dragMove:function(e,s){var a,n=e.touches&&e.touches[0]?e.touches[0].pageX:e.pageX,i=e.touches&&e.touches[0]?e.touches[0].pageY:e.pageY,h=(l=t.$(document.elementFromPoint(n-(document.body.scrollLeft||document.scrollLeft||0),i-(document.body.scrollTop||document.documentElement.scrollTop||0)))).closest("."+this.options.baseClass),d=h.data("sortable-group"),u=t.$(o),c=u.parent(),p=u.data("sortable-group");h[0]!==c[0]&&void 0!==p&&d===p&&(h.data("sortable").addDragHandlers(),r.push(h),h.children().addClass(this.options.childClass),h.children().length>0?(a=l.closest("."+this.options.childClass)).length?a.before(u):h.append(u):l.append(u),UIkit.$doc.trigger("mouseover")),this.checkEmptyList(),this.checkEmptyList(c)},dragEnter:function(e,s){if(!o||o===s)return!0;var a=this.dragenterData(s);if(this.dragenterData(s,a+1),0===a){var n=t.$(s).parent(),r=t.$(o).data("start-list");if(n[0]!==r[0]){var i=n.data("sortable-group"),l=t.$(o).data("sortable-group");if((i||l)&&i!=l)return!1}t.$(s).addClass(this.options.overClass),this.moveElementNextTo(o,s)}return!1},dragEnd:function(a,n){var i=this;o&&(this.options.stop(n),this.trigger("stop.uk.sortable",[this])),o=null,s=null,r.push(this.element),r.forEach(function(e,o){t.$(e).children().each(function(){1===this.nodeType&&(t.$(this).removeClass(i.options.overClass).removeClass(i.options.placeholderClass).removeClass(i.options.childClass),i.dragenterData(this,!1))})}),r=[],t.$html.removeClass(this.options.dragMovingClass),this.removeDragHandlers(),e&&(e.remove(),e=null)},dragDrop:function(t,e){"drop"===t.type&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()),this.triggerChangeEvents()},triggerChangeEvents:function(){if(o){var s=t.$(o),a=e.data("origin"),n=s.closest("."+this.options.baseClass),r=[],i=t.$(o);a[0]===n[0]&&e.data("index")!=s.index()?r.push({sortable:this,mode:"moved"}):a[0]!=n[0]&&r.push({sortable:t.$(n).data("sortable"),mode:"added"},{sortable:t.$(a).data("sortable"),mode:"removed"}),r.forEach(function(t,e){t.sortable&&t.sortable.element.trigger("change.uk.sortable",[t.sortable,i,t.mode])})}},dragenterData:function(e,o){if(e=t.$(e),1==arguments.length)return parseInt(e.data("child-dragenter"),10)||0;o?e.data("child-dragenter",Math.max(0,o)):e.removeData("child-dragenter")},moveElementNextTo:function(e,o){!0;var s=this,a=t.$(e).parent().css("min-height",""),n=function(t,e){var o=t.parentNode;if(e.parentNode!=o)return!1;var s=t.previousSibling;for(;s&&9!==s.nodeType;){if(s===e)return!0;s=s.previousSibling}return!1}(e,o)?o:o.nextSibling,r=a.children(),i=r.length;if(!s.options.animation)return o.parentNode.insertBefore(e,n),void t.Utils.checkDisplay(s.element.parent());a.css("min-height",a.height()),r.stop().each(function(){var e=t.$(this),o=e.position();o.width=e.width(),e.data("offset-before",o)}),o.parentNode.insertBefore(e,n),t.Utils.checkDisplay(s.element.parent()),(r=a.children().each(function(){var e=t.$(this);e.data("offset-after",e.position())}).each(function(){var e=t.$(this),o=e.data("offset-before");e.css({position:"absolute",top:o.top,left:o.left,"min-width":o.width})})).each(function(){var e=t.$(this),o=(e.data("offset-before"),e.data("offset-after"));e.css("pointer-events","none").width(),setTimeout(function(){e.animate({top:o.top,left:o.left},s.options.animation,function(){e.css({position:"",top:"",left:"","min-width":"","pointer-events":""}).removeClass(s.options.overClass).removeData("child-dragenter"),--i||(a.css("min-height",""),t.Utils.checkDisplay(s.element.parent()))})},0)})},serialize:function(){var e,o,s=[];return this.element.children().each(function(a,n){e={};for(var r=0;r<n.attributes.length;r++)0===(o=n.attributes[r]).name.indexOf("data-")&&(e[o.name.substr(5)]=t.Utils.str2json(o.value));s.push(e)}),s},checkEmptyList:function(e){e=e?t.$(e):this.element,this.options.emptyClass&&e[e.children().length?"removeClass":"addClass"](this.options.emptyClass)}}),t.sortable});